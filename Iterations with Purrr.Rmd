---
title: "Iteration with Purrr"
author: "Joseph Walker"
date: "December 13, 2018"
output: html_document
---

```{r}
library(tidyverse)
library(repurrrsive)

#load the dataset
data("sw_species")

#examine the first element in sw_species
glimpse(sw_species[[2]])

```


As shown above, we can use double brackets to subset an item or element in a list. In the case of the `sw_species` list, the second element corresponds to another list composed of information for Yoda's species.

Another way to subset a list is by name using the `$` followed by the `listelementname` but the `sw_species` does not have names so we can't do this yet.

```{r}
#Get the names of the list elements
names(sw_species)
```

Our first task then will be to apply names to each element using the `$name` subelement from each species sublist. One way to do this is by going through each list individually as so:

```{r}
#get the name element from the first list in sw_species
(names(sw_species)[[1]] <- sw_species[[1]]$name)

#examines the names of the sw_species once again
names(sw_species)
```

This is painstakingly tedious and inefficent. One could use a for loop to do this, but there's an even better way.

We'll use the `map` function to iterate over the sw_species list to extract the names subelement of each species and name that list accordingly. Still with me?

```{r}
#name the list of sw_species using the names subelement
names(sw_species) <- map(sw_species, ~.x$name)

#examine the names of sw_species
names(sw_species)

#subset one of the lists using the $listelementname
sw_species$Ewok
```

We're off to a good start. By default, the map function returns elements in the form of a list. But there are variants such as `map_dbl` and `map_df` which will return the elements based on the type of class.

As an example, let's use the `map_chr` function to grab the `$language` element from each species list and return it as a dataframe.

In order to do so we need to clarify a few things first:

**To specify how the list is used in the function, use the argument .x to denote where the list element goes inside the function. When you want to use .x to show where the element goes in the function, you need to put a ~ in front of the function in the second argument of map().**

```{r}

data.frame(culture = map_chr(sw_species, ~.x$language)) %>%
  rownames_to_column(var = "character") %>%
  head(10)
```




